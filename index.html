<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Como Criar uma API com Node.js, MySQL e Frontend</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/monokai-sublime.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/json.min.js"></script>
  <script>hljs.highlightAll();</script>
  <style>
    pre code {
      border-radius: 0.5rem;
      padding: 1rem;
      font-size: 0.9rem;
      line-height: 1.5;
    }
    .search-bar {
      transition: all 0.3s ease;
    }
    .search-bar:focus {
      box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
    }
  </style>
</head>
<body class="bg-gray-50 font-sans text-gray-800">
  <!-- Header -->
  <header class="bg-blue-800 text-white shadow-lg">
    <div class="container mx-auto px-6 py-4 flex justify-between items-center">
      <h1 class="text-2xl font-bold">Escrito por Caique Cardim</h1>
      <div class="flex items-center space-x-4">
        <input 
          type="text" 
          placeholder="Pesquisar no guia..." 
          class="search-bar px-4 py-2 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-300"
        >
        <a 
          href="https://github.com/kyo5hy" 
          target="_blank" 
          class="text-lg font-semibold hover:text-blue-200 transition-colors"
        >
          Kyoshy
        </a>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="container mx-auto px-6 py-12 max-w-5xl">
    <section class="mb-12">
      <h1 class="text-4xl font-bold text-blue-800 mb-6 text-center">
        API REST com Node.js e MySQL: Padr√£o Reposit√≥rio e Melhores Pr√°ticas
      </h1>
      <div class="bg-white p-8 rounded-lg shadow-lg text-center">
        <p class="text-lg text-gray-700 leading-relaxed mb-4">
          Este projeto demonstra como integrar Node.js com MySQL utilizando as melhores pr√°ticas, como o Padr√£o Reposit√≥rio, que separa a l√≥gica de neg√≥cios da l√≥gica de acesso a dados. Al√©m disso, implementa uma API RESTful completa com opera√ß√µes CRUD usando Express.
          Para garantir qualidade e confiabilidade, tamb√©m inclui testes automatizados com Jest.
        </p>
        <p class="text-lg text-gray-700 leading-relaxed mb-6">
          Este projeto mostra como criar:
        </p>
        <div class="grid grid-cols-1 sm:grid-cols-3 gap-4 max-w-2xl mx-auto">
          <div class="bg-blue-50 p-4 rounded-lg">
            <p class="text-blue-800 font-semibold">‚úÖ Backend</p>
            <p class="text-gray-700">Node.js</p>
          </div>
          <div class="bg-blue-50 p-4 rounded-lg">
            <p class="text-blue-800 font-semibold">‚úÖ Banco de Dados</p>
            <p class="text-gray-700">MySQL</p>
          </div>
          <div class="bg-blue-50 p-4 rounded-lg">
            <p class="text-blue-800 font-semibold">‚úÖ Frontend</p>
            <p class="text-gray-700">HTML Simples</p>
          </div>
          <div class="bg-blue-50 p-4 rounded-lg">
            <p class="text-blue-800 font-semibold">‚úÖ Node.js</p>
            <p class="text-gray-700">Criar API REST</p>
          </div>
          <div class="bg-blue-50 p-4 rounded-lg">
            <p class="text-blue-800 font-semibold">‚úÖ Ferramentas</p>
            <p class="text-gray-700">Insomnia e Workbench</p>
          </div>
          <div class="bg-blue-50 p-4 rounded-lg">
            <p class="text-blue-800 font-semibold">‚úÖ Padr√£o Reposit√≥rio</p>
            <p class="text-gray-700">Organiza√ß√£o de C√≥digo</p>
          </div>
        </div>
      </div>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-lg mb-10">
      <h2 class="text-3xl font-semibold text-blue-800 mb-6">üõ†Ô∏è 1. Entendendo as Ferramentas</h2>
      <p class="text-gray-700 mb-6 leading-relaxed">Antes de come√ßar, entenda para que serve cada ferramenta:</p>
      <ul class="list-disc list-inside text-gray-700 space-y-3">
        <li><strong>Node.js</strong>: Um ambiente de execu√ß√£o que permite rodar JavaScript fora do navegador, no servidor. Usamos para criar o backend ‚Äî o c√©rebro que processa e responde √†s requisi√ß√µes.</li>
        <li><strong>MySQL</strong>: Um sistema de banco de dados relacional. Ele armazena informa√ß√µes importantes, como o nome e e-mail dos usu√°rios que registraremos.</li>
        <li><strong>MySQL Workbench</strong>: Uma ferramenta visual que simplifica a cria√ß√£o de bancos de dados, execu√ß√£o de comandos SQL e visualiza√ß√£o de tabelas graficamente ‚Äî sem depender apenas da linha de comando.</li>
        <li><strong>Visual Studio Code (VSCode)</strong>: O editor onde voc√™ escrever√° o c√≥digo.</li>
        <li>‚ûï <strong>Extens√£o "Live Server"</strong>: Permite abrir p√°ginas HTML localmente com atualiza√ß√µes autom√°ticas sempre que voc√™ salvar o arquivo.</li>
      </ul>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-lg mb-10">
      <h2 class="text-3xl font-semibold text-blue-800 mb-6">üìÇ 2. Organiza√ß√£o do Projeto</h2>
      <p class="text-gray-700 mb-6 leading-relaxed">Criar uma estrutura organizada torna o c√≥digo mais f√°cil de entender e manter. Veja como ficar√° a pasta do projeto:</p>
      <pre><code class="language-plaintext">
node-mysql-repository/
‚îú‚îÄ‚îÄ repositories/        # Armazena a l√≥gica de acesso a dados
‚îú‚îÄ‚îÄ .env                 # Arquivo com credenciais (usu√°rio e senha)
‚îú‚îÄ‚îÄ app.js               # Arquivo principal: define o servidor e rotas
‚îú‚îÄ‚îÄ db.js                # Gerencia a conex√£o com o banco de dados
‚îú‚îÄ‚îÄ initDB.js            # Cria automaticamente a tabela se ela n√£o existir
‚îú‚îÄ‚îÄ index.html           # A interface visual (frontend)
‚îú‚îÄ‚îÄ package.json         # Arquivo que descreve as depend√™ncias (bibliotecas)
      </code></pre>
      <p class="text-gray-700 mt-6 leading-relaxed">‚úÖ <strong>Importante:</strong> Cada parte tem uma fun√ß√£o bem definida, tornando o c√≥digo mais organizado e f√°cil de manter.</p>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-lg mb-10">
      <h2 class="text-3xl font-semibold text-blue-800 mb-6">üõ¢Ô∏è 3. Criando o Banco de Dados</h2>
      <p class="text-gray-700 mb-6 leading-relaxed">O banco de dados √© onde <strong>armazenamos as informa√ß√µes dos usu√°rios</strong>.</p>
      <p class="text-gray-700 mb-6 leading-relaxed">No MySQL Workbench ou no terminal do MySQL, execute os seguintes comandos:</p>
      <pre><code class="language-sql">
CREATE DATABASE testdb;   -- Cria o banco de dados chamado testdb
USE testdb;               -- Seleciona este banco de dados para trabalhar

CREATE TABLE users (
  id INT AUTO_INCREMENT PRIMARY KEY,  -- ID √∫nico que incrementa automaticamente
  name VARCHAR(255),                  -- Nome do usu√°rio (at√© 255 caracteres)
  email VARCHAR(255)                  -- E-mail do usu√°rio
);
      </code></pre>
      <p class="text-gray-700 mt-6 leading-relaxed">üîç <strong>Por que fazer assim?</strong></p>
      <ul class="list-disc list-inside text-gray-700 space-y-3">
        <li>A tabela <code>users</code> ter√° tr√™s campos:</li>
        <li>‚û°Ô∏è <code>id</code>: Um n√∫mero √∫nico que identifica cada usu√°rio.</li>
        <li>‚û°Ô∏è <code>name</code>: O nome do usu√°rio.</li>
        <li>‚û°Ô∏è <code>email</code>: O e-mail do usu√°rio.</li>
        <li><code>AUTO_INCREMENT</code>: Garante que o banco de dados atribua automaticamente um <code>id</code> √∫nico para cada novo usu√°rio, evitando duplicatas.</li>
      </ul>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-lg mb-10">
      <h2 class="text-3xl font-semibold text-blue-800 mb-6">üîë 4. Configurando a Conex√£o com o Banco de Dados</h2>
      <h3 class="text-2xl font-semibold text-gray-800 mb-4">üìÑ 4.1 O Arquivo <code>.env</code></h3>
      <p class="text-gray-700 mb-6 leading-relaxed">O arquivo <code>.env</code> armazena as credenciais de forma <strong>segura</strong> e <strong>separada</strong> do c√≥digo principal:</p>
      <pre><code class="language-plaintext">
DB_HOST=localhost
DB_USER=root
DB_PASS=your_password
DB_NAME=testdb
      </code></pre>
      <p class="text-gray-700 mt-6 leading-relaxed">‚û°Ô∏è <strong>Por qu√™?</strong> Evita expor senhas no c√≥digo e facilita altera√ß√µes: se o usu√°rio ou senha mudar, basta atualizar este arquivo.</p>

      <h3 class="text-2xl font-semibold text-gray-800 mb-4 mt-8">üìÑ 4.2 O Arquivo <code>db.js</code></h3>
      <p class="text-gray-700 mb-6 leading-relaxed">Este c√≥digo <strong>conecta</strong> nossa aplica√ß√£o ao banco de dados:</p>
      <pre><code class="language-javascript">
const mysql = require('mysql2/promise');  // Biblioteca para MySQL
require('dotenv').config();               // Carrega automaticamente o arquivo .env

const pool = mysql.createPool({
  host: process.env.DB_HOST,     // Obtido do .env
  user: process.env.DB_USER,
  password: process.env.DB_PASS,
  database: process.env.DB_NAME
});

module.exports = pool;  // Exporta para uso em outras partes
      </code></pre>
      <p class="text-gray-700 mt-6 leading-relaxed">‚û°Ô∏è <strong>Por que usar <code>createPool</code>?</strong> O <code>createPool</code> cria um <strong>pool de conex√µes</strong>, ou seja, v√°rias conex√µes est√£o dispon√≠veis para uso, tornando o acesso ao banco de dados mais <strong>eficiente e r√°pido</strong>. Isso evita abrir e fechar uma nova conex√£o para cada opera√ß√£o.</p>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-lg mb-10">
      <h2 class="text-3xl font-semibold text-blue-800 mb-6">üíæ 5. Criando o Reposit√≥rio</h2>
      <p class="text-gray-700 mb-6 leading-relaxed">O <strong>Reposit√≥rio</strong> √© uma camada de c√≥digo onde centralizamos toda a l√≥gica de intera√ß√£o com o banco de dados, mantendo a aplica√ß√£o organizada e separada.</p>
      <pre><code class="language-javascript">
const db = require('../db');  // Importa a conex√£o

class UserRepository {
  // Criar usu√°rio
  async create(user) {
    const [result] = await db.execute(
      'INSERT INTO users (name, email) VALUES (?, ?)',
      [user.name, user.email]
    );
    return { id: result.insertId, ...user };
  }

  // Buscar por ID
  async findById(id) {
    const [rows] = await db.execute('SELECT * FROM users WHERE id = ?', [id]);
    return rows[0];
  }

  // Listar todos
  async findAll() {
    const [rows] = await db.execute('SELECT * FROM users');
    return rows;
  }

  // Atualizar
  async update(id, user) {
    await db.execute(
      'UPDATE users SET name = ?, email = ? WHERE id = ?',
      [user.name, user.email, id]
    );
  }

  // Deletar
  async delete(id) {
    await db.execute('DELETE FROM users WHERE id = ?', [id]);
  }
}

module.exports = new UserRepository();
      </code></pre>
      <p class="text-gray-700 mt-6 leading-relaxed">‚úÖ <strong>Explica√ß√£o detalhada dos comandos SQL usados:</strong></p>
      <ul class="list-disc list-inside text-gray-700 space-y-3">
        <li><code>INSERT INTO</code>: Insere um novo registro na tabela.</li>
        <li><code>VALUES (?, ?)</code>: Usamos <code>?</code> como <strong>placeholders</strong> para prevenir ataques de SQL Injection e tornar o c√≥digo mais seguro.</li>
        <li><code>SELECT * FROM</code>: Recupera todos os campos de um ou mais registros.</li>
        <li><code>WHERE id = ?</code>: Especifica uma <strong>condi√ß√£o</strong> ‚Äî neste caso, seleciona um usu√°rio espec√≠fico por <code>id</code>.</li>
        <li><code>UPDATE</code>: Atualiza campos de um registro existente.</li>
        <li><code>DELETE</code>: Remove um registro da tabela.</li>
      </ul>
      <p class="text-gray-700 mt-6 leading-relaxed">‚û°Ô∏è <strong>Por que separar assim?</strong> Para manter a l√≥gica organizada, manuten√≠vel e reutiliz√°vel. Por exemplo, se quisermos mudar como os usu√°rios s√£o recuperados, basta modificar esta parte.</p>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-lg mb-10">
      <h2 class="text-3xl font-semibold text-blue-800 mb-6">üåê 6. Criando a API (Servidor)</h2>
      <p class="text-gray-700 mb-6 leading-relaxed">Agora vamos criar o <strong>servidor</strong> que lida com as requisi√ß√µes e responde adequadamente.</p>
      <pre><code class="language-javascript">
const express = require('express');
const cors = require('cors');
const userRepository = require('./repositories/UserRepository');

const app = express();

app.use(cors());             // Habilita o acesso √† API
app.use(express.json());     // Permite analisar JSON no corpo da requisi√ß√£o

// Listar todos os usu√°rios
app.get('/users', async (req, res) => {
  const users = await userRepository.findAll();
  res.json(users);
});

// Criar novo usu√°rio
app.post('/users', async (req, res) => {
  const user = await userRepository.create(req.body);
  res.status(201).json(user);
});

// Atualizar usu√°rio
app.put('/users/:id', async (req, res) => {
  await userRepository.update(req.params.id, req.body);
  res.sendStatus(204);
});

// Deletar usu√°rio
app.delete('/users/:id', async (req, res) => {
  await userRepository.delete(req.params.id);
  res.sendStatus(204);
});

app.listen(3000, () => console.log('üöÄ Server running on http://localhost:3000'));
      </code></pre>
      <p class="text-gray-700 mt-6 leading-relaxed">‚úÖ <strong>O que est√° acontecendo aqui?</strong></p>
      <ul class="list-disc list-inside text-gray-700 space-y-3">
        <li><code>GET /users</code>: Lista todos os usu√°rios.</li>
        <li><code>POST /users</code>: Cria um novo usu√°rio com os dados enviados no corpo da requisi√ß√£o.</li>
        <li><code>PUT /users/:id</code>: Atualiza um usu√°rio espec√≠fico identificado por <code>id</code>.</li>
        <li><code>DELETE /users/:id</code>: Deleta o usu√°rio com o <code>id</code> especificado.</li>
      </ul>
      <p class="text-gray-700 mt-6 leading-relaxed">‚û°Ô∏è <strong>Por que usar <code>userRepository</code>?</strong> Ele centraliza todas as opera√ß√µes do banco de dados, ent√£o o servidor apenas <strong>chama m√©todos</strong> (<code>findAll</code>, <code>create</code>, <code>update</code>, <code>delete</code>), mantendo o c√≥digo limpo e separado.</p>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-lg mb-10">
      <h2 class="text-3xl font-semibold text-blue-800 mb-6">üèóÔ∏è 7. Criando a Tabela Automaticamente</h2>
      <p class="text-gray-700 mb-6 leading-relaxed">Este arquivo garante que a tabela <code>users</code> seja criada automaticamente se n√£o existir.</p>
      <pre><code class="language-javascript">
const db = require('./db');

async function init() {
  await db.execute(`
    CREATE TABLE IF NOT EXISTS users (
      id INT AUTO_INCREMENT PRIMARY KEY,
      name VARCHAR(255),
      email VARCHAR(255)
    )
  `);
  console.log('‚úÖ Tabela de usu√°rios verificada/criada');
}

init();
      </code></pre>
      <p class="text-gray-700 mt-6 leading-relaxed">‚û°Ô∏è <strong>Por que isso √© √∫til?</strong> Evita erros ao executar o projeto pela primeira vez ou em novos ambientes, garantindo que a tabela necess√°ria exista sem cria√ß√£o manual.</p>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-lg mb-10">
      <h2 class="text-3xl font-semibold text-blue-800 mb-6">üé® 8. Criando o Frontend (Interface)</h2>
      <p class="text-gray-700 mb-6 leading-relaxed">Agora vamos criar uma interface HTML simples para interagir com nossa API:</p>
      <pre><code class="language-html">
<input type="text" id="addName" placeholder="Nome">
<input type="email" id="addEmail" placeholder="E-mail">
<button onclick="addUser()">Adicionar</button>

<script>
  async function addUser() {
    const name = document.getElementById('addName').value;
    const email = document.getElementById('addEmail').value;

    await fetch('http://localhost:3000/users', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ name, email })
    });

    alert('Usu√°rio adicionado com sucesso!');
  }
</script>
      </code></pre>
      <p class="text-gray-700 mt-6 leading-relaxed">‚û°Ô∏è <strong>Como funciona?</strong></p>
      <ol class="list-decimal list-inside text-gray-700 space-y-3">
        <li>O usu√°rio preenche os campos <code>Nome</code> e <code>E-mail</code>.</li>
        <li>Clica no bot√£o "Adicionar".</li>
        <li>A fun√ß√£o <code>addUser()</code> obt√©m esses valores e envia uma <strong>requisi√ß√£o HTTP POST</strong> para a API com os dados.</li>
        <li>O backend recebe, processa e armazena os dados no banco de dados.</li>
        <li>O frontend exibe um alerta confirmando a a√ß√£o.</li>
      </ol>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-lg mb-10">
      <h2 class="text-3xl font-semibold text-blue-800 mb-6">üß™ 9. Como Testar Tudo</h2>
      <p class="text-gray-700 mb-6 leading-relaxed">‚úÖ <strong>Passos:</strong></p>
      <ol class="list-decimal list-inside text-gray-700 space-y-3">
        <li><strong>No terminal:</strong></li>
        <ul class="list-disc list-inside ml-6 space-y-2">
          <li><code>node initDB.js</code> ‚Üí Garante que a tabela seja criada.</li>
          <li><code>node app.js</code> ‚Üí Inicia o servidor.</li>
        </ul>
        <li><strong>No navegador:</strong></li>
        <ul class="list-disc list-inside ml-6 space-y-2">
          <li>Abra o <code>index.html</code> com o Live Server.</li>
          <li>Preencha <code>Nome</code> e <code>E-mail</code> ‚Üí clique em "Adicionar".</li>
        </ul>
        <li>Verifique se o alerta aparece e se os dados foram armazenados no banco de dados.</li>
      </ol>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-lg mb-10">
      <h2 class="text-3xl font-semibold text-blue-800 mb-6">üöÄ Como Testar com Insomnia ou Postman</h2>
      <ol class="list-decimal list-inside text-gray-700 space-y-3">
        <li>Abra o <strong>Insomnia</strong> (ou <strong>Postman</strong>).</li>
        <li>Crie uma <strong>nova requisi√ß√£o</strong> com o m√©todo desejado:</li>
        <ul class="list-disc list-inside ml-6 space-y-3">
          <li>‚úÖ <code>GET</code> ‚Üí <code>http://localhost:3000/users</code> ‚Üí Retorna todos os usu√°rios.</li>
          <li>‚úÖ <code>POST</code> ‚Üí <code>http://localhost:3000/users</code> ‚Üí Envie um <strong>JSON</strong> no corpo:</li>
          <pre><code class="language-json">
{ "name": "Jo√£o", "email": "joao@email.com" }
          </code></pre>
          <li>‚úÖ <code>PUT</code> ‚Üí <code>http://localhost:3000/users/1</code> ‚Üí Atualiza o usu√°rio com ID 1.</li>
          <li>‚úÖ <code>DELETE</code> ‚Üí <code>http://localhost:3000/users/1</code> ‚Üí Deleta o usu√°rio com ID 1.</li>
        </ul>
        <li>Clique em "Enviar" e verifique as respostas da API.</li>
      </ol>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-lg mb-10">
      <h2 class="text-3xl font-semibold text-blue-800 mb-6">üí° 10. Dicas Extras</h2>
      <ul class="list-disc list-inside text-gray-700 space-y-3">
        <li><strong>Use Insomnia ou Postman</strong> para testar as rotas antes de criar a interface HTML.</li>
        <li><strong>Automatize</strong> rein√≠cios:</li>
        <ul class="list-disc list-inside ml-6 space-y-2">
          <li>‚û°Ô∏è Instale o <code>nodemon</code>: <code>npm install -g nodemon</code></li>
          <li>‚û°Ô∏è Depois execute: <code>nodemon app.js</code></li>
        </ul>
        <li><strong>Melhorias futuras:</strong></li>
        <ul class="list-disc list-inside ml-6 space-y-2">
          <li>‚û°Ô∏è Adicione um bot√£o para listar todos os usu√°rios e exibi-los em uma tabela no frontend.</li>
          <li>‚û°Ô∏è Atualize para frameworks como <strong>React</strong> ou <strong>Vue.js</strong> para interfaces mais interativas e sofisticadas.</li>
        </ul>
      </ul>
    </section>

    <section class="bg-white p-8 rounded-lg shadow-lg">
      <h2 class="text-3xl font-semibold text-blue-800 mb-6">‚úÖ 11. Conclus√£o</h2>
      <p class="text-gray-700 mb-6 leading-relaxed">Agora voc√™ tem uma aplica√ß√£o <strong>completa</strong>!</p>
      <ul class="list-disc list-inside text-gray-700 space-y-3">
        <li>‚úÖ Criar e organizar um backend com Node.js</li>
        <li>‚úÖ Integrar com um banco de dados MySQL</li>
        <li>‚úÖ Aplicar melhores pr√°ticas: Padr√£o Reposit√≥rio</li>
        <li>‚úÖ Implementar valida√ß√£o e tratamento de erros</li>
        <li>‚úÖ Habilitar CORS para o frontend</li>
        <li>‚úÖ Criar uma interface web interativa para consumir a API</li>
      </ul>
      <p class="text-gray-700 mt-6 leading-relaxed">‚û°Ô∏è <strong>Por que isso √© importante?</strong> Este √© o modelo b√°sico de muitos sistemas usados em empresas e startups. Agora voc√™ entende como <strong>backend</strong>, <strong>banco de dados</strong> e <strong>frontend</strong> se <strong>conectam</strong>!</p>
    </section>
  </main>

  <!-- Footer -->
  <footer class="bg-gray-800 text-white py-6">
    <div class="container mx-auto px-6 text-center">
      <p>Desenvolvido por <a href="https://github.com/kyo5hy" target="_blank" class="underline hover:text-blue-300">Kyoshy</a> | 2025</p>
    </div>
  </footer>
</body>
</html>
